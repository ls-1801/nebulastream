# name: function/filter/CeilComparison.test
# description: Test CEIL(speed) != UINT64(0) OR altitude == 0
# groups: [Function, Filter, Ceil]

# Define source
CREATE LOGICAL SOURCE s(speed FLOAT64, altitude FLOAT64);
CREATE PHYSICAL SOURCE FOR s TYPE File;
ATTACH INLINE
0.2, 100
-0.7,  50
0.0,   0
1.1,   5
-1.2,  0
2.9,   7
3.0,   0
-0.1,  9
0.01,  1
5.4,   8

# Define sink
# CREATE SINK sink(speed FLOAT64, altitude FLOAT64) TYPE File;
CREATE SINK sink(`S$SPEED` FLOAT64, `S$ALTITUDE` FLOAT64) TYPE File;

# Query under test
SELECT *
FROM s
WHERE CEIL(speed) != UINT64(0)
   OR altitude == UINT64(0)
INTO sink;
----
0.0,   0      # altitude == 0 → keep
1.1,   5      # CEIL(1.1) = 2 → keep
-1.2,  0      # altitude == 0 → keep
2.9,   7      # CEIL(2.9) = 3 → keep
3.0,   0      # altitude == 0 → keep
0.01,  1      # CEIL(0.01) = 1 → keep
5.4,   8      # CEIL(5.4) = 6 → keep
