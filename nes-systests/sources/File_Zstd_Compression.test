# name: sources/FileZstdCompression.test
# description: Tests FileSource with zstd compression
# groups: [Sources]

CREATE LOGICAL SOURCE zstd_stream(id UINT64, value UINT64, timestamp UINT64);

CREATE PHYSICAL SOURCE FOR zstd_stream TYPE File SET('zstd' AS `SOURCE`.COMPRESSION);
ATTACH FILE small/stream8.csv.zst

CREATE SINK zstd_sink(zstd_stream.id UINT64, zstd_stream.value UINT64, zstd_stream.timestamp UINT64) TYPE File;

SELECT * FROM zstd_stream INTO zstd_sink;
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
